<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.54">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>C2C #1: Game Theory – Cards to Code</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="././assets/logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-68E8GHZRHQ"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-68E8GHZRHQ', { 'anonymize_ip': true});
</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="C2C #1: Game Theory – Cards to Code">
<meta property="og:description" content="">
<meta property="og:site_name" content="Cards to Code">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="././assets/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Cards to Code</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://overbet.ai"> 
<span class="menu-text">Overbet.ai</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools tools-wide">
    <a href="https://discord.gg/KZQK2xN8Da" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-discord"></i></a>
    <a href="https://overbetai.substack.com/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-mailbox2-flag"></i></a>
    <a href="https://github.com/overbetai/cardstocode" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./1_gametheory.html">#1: Game Theory</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup and Face-up Poker</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1_gametheory.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">#1: Game Theory</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2_kuhnpoker.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">#2: Kuhn Poker</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3_gametrees.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">#3: Game Trees</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4_regret.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">#4: Regret</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5_cfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">#5: CFR</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6_mccfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">#6: Monte Carlo CFR</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7_kuhncfr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">#7: Evals and Results</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8_100cardkuhn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">#8: 100-card Kuhn</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./9_opponentmodeling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">#9: Opponent Modeling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_challenge.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">#10: Challenge Projects</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./next.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Next Directions</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#types-of-games" id="toc-types-of-games" class="nav-link active" data-scroll-target="#types-of-games">Types of games</a>
  <ul class="collapse">
  <li><a href="#perfect-information-games" id="toc-perfect-information-games" class="nav-link" data-scroll-target="#perfect-information-games">Perfect information games</a></li>
  <li><a href="#imperfect-information-games" id="toc-imperfect-information-games" class="nav-link" data-scroll-target="#imperfect-information-games">Imperfect information games</a></li>
  <li><a href="#winning-games" id="toc-winning-games" class="nav-link" data-scroll-target="#winning-games">Winning games</a></li>
  </ul></li>
  <li><a href="#rock-paper-scissors" id="toc-rock-paper-scissors" class="nav-link" data-scroll-target="#rock-paper-scissors">Rock Paper Scissors</a>
  <ul class="collapse">
  <li><a href="#payoff-matrix" id="toc-payoff-matrix" class="nav-link" data-scroll-target="#payoff-matrix">Payoff matrix</a></li>
  <li><a href="#expected-value" id="toc-expected-value" class="nav-link" data-scroll-target="#expected-value">Expected value</a></li>
  <li><a href="#zero-sum" id="toc-zero-sum" class="nav-link" data-scroll-target="#zero-sum">Zero-sum</a></li>
  <li><a href="#nash-equilibrium" id="toc-nash-equilibrium" class="nav-link" data-scroll-target="#nash-equilibrium">Nash equilibrium</a></li>
  <li><a href="#exploiting-vs.-nash" id="toc-exploiting-vs.-nash" class="nav-link" data-scroll-target="#exploiting-vs.-nash">Exploiting vs.&nbsp;Nash</a></li>
  </ul></li>
  <li><a href="#soccer-kicker-vs.-goalie" id="toc-soccer-kicker-vs.-goalie" class="nav-link" data-scroll-target="#soccer-kicker-vs.-goalie">Soccer Kicker vs.&nbsp;Goalie</a>
  <ul class="collapse">
  <li><a href="#nash-equilibrium-1" id="toc-nash-equilibrium-1" class="nav-link" data-scroll-target="#nash-equilibrium-1">Nash equilibrium?</a></li>
  <li><a href="#probabilistic-interpretations" id="toc-probabilistic-interpretations" class="nav-link" data-scroll-target="#probabilistic-interpretations">Probabilistic interpretations</a></li>
  <li><a href="#finding-equilibrium" id="toc-finding-equilibrium" class="nav-link" data-scroll-target="#finding-equilibrium">Finding equilibrium</a></li>
  <li><a href="#switching-out-of-equilibrium" id="toc-switching-out-of-equilibrium" class="nav-link" data-scroll-target="#switching-out-of-equilibrium">Switching out of equilibrium</a></li>
  <li><a href="#whats-up-with-indifference" id="toc-whats-up-with-indifference" class="nav-link" data-scroll-target="#whats-up-with-indifference">What’s up with indifference?</a></li>
  <li><a href="#deviating-from-nash" id="toc-deviating-from-nash" class="nav-link" data-scroll-target="#deviating-from-nash">Deviating from Nash</a></li>
  <li><a href="#indifference" id="toc-indifference" class="nav-link" data-scroll-target="#indifference">Indifference</a></li>
  </ul></li>
  <li><a href="#clairvoyance-poker" id="toc-clairvoyance-poker" class="nav-link" data-scroll-target="#clairvoyance-poker">Clairvoyance Poker</a>
  <ul class="collapse">
  <li><a href="#equity-and-variance" id="toc-equity-and-variance" class="nav-link" data-scroll-target="#equity-and-variance">Equity and Variance</a></li>
  <li><a href="#betting-rules-and-sequences" id="toc-betting-rules-and-sequences" class="nav-link" data-scroll-target="#betting-rules-and-sequences">Betting Rules and Sequences</a></li>
  <li><a href="#starting-strategies" id="toc-starting-strategies" class="nav-link" data-scroll-target="#starting-strategies">Starting Strategies</a></li>
  <li><a href="#dominated-strategy" id="toc-dominated-strategy" class="nav-link" data-scroll-target="#dominated-strategy">Dominated Strategy</a></li>
  <li><a href="#your-strategies" id="toc-your-strategies" class="nav-link" data-scroll-target="#your-strategies">Your Strategies</a></li>
  <li><a href="#indifference-in-poker" id="toc-indifference-in-poker" class="nav-link" data-scroll-target="#indifference-in-poker">Indifference in Poker</a></li>
  <li><a href="#equity-vs.-expected-value" id="toc-equity-vs.-expected-value" class="nav-link" data-scroll-target="#equity-vs.-expected-value">Equity vs.&nbsp;Expected Value</a></li>
  <li><a href="#exploits" id="toc-exploits" class="nav-link" data-scroll-target="#exploits">exploits</a></li>
  <li><a href="#bonus-bet-sizing" id="toc-bonus-bet-sizing" class="nav-link" data-scroll-target="#bonus-bet-sizing">Bonus: Bet Sizing</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">C2C #1: Game Theory</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="types-of-games" class="level2">
<h2 class="anchored" data-anchor-id="types-of-games">Types of games</h2>
<p>The most simple type of game is the one that we built in the <a href="./setup.html">setup</a> section. Cards get flipped over and you either win or lose. Not much skill…and not much fun!</p>
<p>Other games like Bingo, Dreidel, and of course Snakes and Ladders can deceptively seem like you have strategic control of the game, but really this is just the “illusion of agency”, since you’re only, for example, rolling dice to randomize your next move. A disturbing fact:</p>
<p><img src="assets/eliezer_snakes.jpg" class="img-fluid"></p>
<p>There are three main classes of games that do have significant strategic agency: <strong>perfect information</strong>, <strong>perfect information with randomness</strong>, and <strong>imperfect (hidden) information</strong>.</p>
<p>We can also think about games along the axis of <strong>fixed or random opponents</strong> and <strong>adversarial opponents</strong>.</p>
<p>(There are also other game classes like sequential vs.&nbsp;simultaneous action games.)</p>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 35%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Game/Opponent</th>
<th>Fixed/Random Opponent</th>
<th>Adversarial Opponent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>No Player Agency/Decisions</strong></td>
<td>Candy Land, War, Dreidel, Bingo, Snakes and Ladders</td>
<td>Blackjack dealer</td>
</tr>
<tr class="even">
<td><strong>Perfect Info</strong></td>
<td>Puzzles, Rubix cube</td>
<td>Tictactoe, Checkers, Chess, Arimaa, Go, Connect Four</td>
</tr>
<tr class="odd">
<td><strong>Perfect Info with Randomness</strong></td>
<td>Monopoly, Risk</td>
<td>Backgammon</td>
</tr>
<tr class="even">
<td><strong>Imperfect Info</strong></td>
<td>Wordle, Blackjack</td>
<td>Poker, Rock Paper Scissors, Figgie, StarCraft</td>
</tr>
</tbody>
</table>
<section id="perfect-information-games" class="level3">
<h3 class="anchored" data-anchor-id="perfect-information-games">Perfect information games</h3>
<p>Perfect information games like Chess and Go are complex and have been the focus of recent AI research (along with poker). Solving these games can theoretically be done using <strong>backward induction</strong>, which means starting from possible end positions and working backwards.</p>
</section>
<section id="imperfect-information-games" class="level3">
<h3 class="anchored" data-anchor-id="imperfect-information-games">Imperfect information games</h3>
<p>Here we want to primarily focus on the bottom right of this chart: imperfect information games with an adversarial opponent.</p>
<p>These games cannot be solved in the same way as perfect information games because we don’t know always what true state of the game we are in because of the hidden information (we’ll look at this more in <a href="./3_gametrees.html">Game Trees</a>).</p>
<p>Imperfect information games are representative of real world situations where information is usually incomplete, e.g.&nbsp;job interviews, investments, dating, and negotiations.</p>
</section>
<section id="winning-games" class="level3">
<h3 class="anchored" data-anchor-id="winning-games">Winning games</h3>
<p>The goal of a game is to maximize the <em>utility</em>, which is usually a score or money or some kind of value.</p>
<p>There are two fundamental strategies:</p>
<ol type="1">
<li><p><strong>Exploiting opponent weaknesses:</strong> Capitalize on specific flaws or tendencies of opponents, while putting yourself at risk if the opponent adapts well.</p></li>
<li><p><strong>Being unexploitable:</strong> Playing a balanced, theoretically sound strategy, also known as <em>game theory optimal</em>. This does not maximize against weaker opponents, but rather aims to minimize losses against any possible opponent.</p></li>
</ol>
</section>
</section>
<section id="rock-paper-scissors" class="level2">
<h2 class="anchored" data-anchor-id="rock-paper-scissors">Rock Paper Scissors</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/rps.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Image by <a href="https://en.wikipedia.org/wiki/Rock_paper_scissors#/media/File:Rock-paper-scissors.svg">Enzoklop</a> under <a href="https://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0</a></figcaption>
</figure>
</div>
<ul>
<li>Rock defeats scissors, scissors defeats paper, and paper defeats rock</li>
<li>You get +1 point for a win, -1 for a loss, and 0 for ties</li>
</ul>
<p>This simple game was the subject of a DeepMind paper in 2023, where they wrote:</p>
<blockquote class="blockquote">
<p>In sequential decision-making, agent evaluation has largely been restricted to few interactions against experts, with the aim to reach some desired level of performance (e.g.&nbsp;beating a human professional player). We propose a benchmark for multiagent learning based on repeated play of the simple game Rock, Paper, Scissors.</p>
</blockquote>
<p>Let’s dig in to why RPS is a more interesting game than it might seem.</p>
<section id="payoff-matrix" class="level3">
<h3 class="anchored" data-anchor-id="payoff-matrix">Payoff matrix</h3>
<p>The core features of a game are its players, the actions of each player, and the payoffs. We can show this for RPS in the below payoff matrix, also known as normal-form.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Player 1/2</th>
<th>Rock</th>
<th>Paper</th>
<th>Scissors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Rock</strong></td>
<td>(0, 0)</td>
<td>(-1, 1)</td>
<td>(1, -1)</td>
</tr>
<tr class="even">
<td><strong>Paper</strong></td>
<td>(1, -1)</td>
<td>(0, 0)</td>
<td>(-1, 1)</td>
</tr>
<tr class="odd">
<td><strong>Scissors</strong></td>
<td>(-1, 1)</td>
<td>(1, -1)</td>
<td>(0, 0)</td>
</tr>
</tbody>
</table>
<p>The payoffs for Player 1 are on the left and for Player 2 on the right in each payoff outcome of the game. For example, the bottom left payoff is when Player 1 plays Scissors and Player 2 plays Rock, resulting in -1 for P1 and +1 for P2.</p>
</section>
<section id="expected-value" class="level3">
<h3 class="anchored" data-anchor-id="expected-value">Expected value</h3>
<p>A strategy says which actions you would take for every state of the game.</p>
<p><strong>Expected value</strong> in a game represents the average outcome of a strategy if it were repeated many times. It’s calculated by multiplying each possible outcome by its probability of occurrence and then summing these products.</p>
<p>Suppose that Player 1 plays the strategy:</p>
<p><span class="math display">
\begin{cases}
r = 0.5 \\
p = 0.25 \\
s = 0.25
\end{cases}
</span></p>
<p>and Player 2 plays the strategy:</p>
<p><span class="math display">
\begin{cases}
r = 0.1 \\
p = 0.3 \\
s = 0.6
\end{cases}
</span></p>
<p>Let’s add these to the matrix:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>Player 1/2</th>
<th>Rock (<span class="math inline">r_2=0.1</span>)</th>
<th>Paper (<span class="math inline">p_2=0.3</span>)</th>
<th>Scissors (<span class="math inline">s_2=0.6</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Rock (<span class="math inline">r_1=0.5</span>)</strong></td>
<td>(0, 0)</td>
<td>(-1, 1)</td>
<td>(1, -1)</td>
</tr>
<tr class="even">
<td><strong>Paper (<span class="math inline">p_1=0.25</span>)</strong></td>
<td>(1, -1)</td>
<td>(0, 0)</td>
<td>(-1, 1)</td>
</tr>
<tr class="odd">
<td><strong>Scissors (<span class="math inline">s_1=0.25</span>)</strong></td>
<td>(-1, 1)</td>
<td>(1, -1)</td>
<td>(0, 0)</td>
</tr>
</tbody>
</table>
<p>To simplify, let’s just write the payoffs for Player 1 since payoffs for Player 2 will simply be the opposite:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>Player 1/2</th>
<th>Rock (<span class="math inline">r_2=0.1</span>)</th>
<th>Paper (<span class="math inline">p_2=0.3</span>)</th>
<th>Scissors (<span class="math inline">s_2=0.6</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Rock (<span class="math inline">r_1=0.5</span>)</strong></td>
<td>0</td>
<td>-1</td>
<td>1</td>
</tr>
<tr class="even">
<td><strong>Paper (<span class="math inline">p_1=0.25</span>)</strong></td>
<td>1</td>
<td>0</td>
<td>-1</td>
</tr>
<tr class="odd">
<td><strong>Scissors (<span class="math inline">s_1=0.25</span>)</strong></td>
<td>-1</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Now we can multiply the player action strategies together to get a percentage occurrence for each payoff in the matrix:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>Player 1/2</th>
<th>Rock (<span class="math inline">r_2=0.1</span>)</th>
<th>Paper (<span class="math inline">p_2=0.3</span>)</th>
<th>Scissors (<span class="math inline">s_2=0.6</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Rock (<span class="math inline">r_1=0.5</span>)</strong></td>
<td>Val: 0 <br>Pr: <span class="math inline">0.5(0.1) = 0.05</span></td>
<td>Val: -1 <br>Pr: <span class="math inline">0.5(0.3) = 0.15</span></td>
<td>Val: 1 <br>Pr: <span class="math inline">0.5(0.6) = 0.3</span></td>
</tr>
<tr class="even">
<td><strong>Paper (<span class="math inline">p_1=0.25</span>)</strong></td>
<td>Val: 1 <br>Pr: <span class="math inline">0.25(0.1) = 0.025</span></td>
<td>Val: 0 <br>Pr: <span class="math inline">0.25(0.3) = 0.075</span></td>
<td>Val: -1 <br>Pr: <span class="math inline">0.25(0.6) = .15</span></td>
</tr>
<tr class="odd">
<td><strong>Scissors (<span class="math inline">s_1=0.25</span>)</strong></td>
<td>Val: -1 <br>Pr: <span class="math inline">0.25(0.1) = 0.025</span></td>
<td>Val: 1 <br>Pr: <span class="math inline">0.25(0.3) = 0.075</span></td>
<td>Val: 0 <br>Pr: <span class="math inline">0.25(0.6) = .15</span></td>
</tr>
</tbody>
</table>
<p>Note that the total probabilities sum to 1 and each row and column sums to the probability of playing that row or column.</p>
<p>We can work out the expected value of the game to Player 1 (summing all payoffs multiplied by probabilities from top left to bottom right):</p>
<p><span class="math inline">\mathbb{E} = 0(0.05) + -1(0.15) + 1(0.3) + 1(0.025) + 0(0.075) + -1(0.15) + -1(0.025) + 1(0.075) + 0(0.15) = 0.075</span></p>
<p>Therefore P1 is <em>expected</em> to gain 0.075 per game given these strategies. Since payoffs are reversed for P2, P2’s expectation is -0.075 per game.</p>
</section>
<section id="zero-sum" class="level3">
<h3 class="anchored" data-anchor-id="zero-sum">Zero-sum</h3>
<p>We see in the matrix that every payoff is zero-sum, i.e.&nbsp;the sum of the payoffs to both players is 0. This means the game is one of pure competition. Any amount P1 wins is from P2 and vice versa.</p>
</section>
<section id="nash-equilibrium" class="level3">
<h3 class="anchored" data-anchor-id="nash-equilibrium">Nash equilibrium</h3>
<p>A Nash equilibrium means that no player can improve their expected payoff by unilaterally changing their strategy. That is, changing one’s strategy can only result in the same or worse payoff (assuming the other player does not change).</p>
<p>In RPS, the Nash equilibrium strategy is to play each action <span class="math inline">r = p = s = 1/3</span> of the time. I.e., to play totally randomly.</p>
<p>This is called a mixed strategy, as opposed to a pure strategy, which would select only one action. Mixed strategies are useful in games of imperfect information because it’s valuable to not be predictable and to conceal your private information. In perfect information games, the theoretically optimal play would not contain any mixing (i.e., if you could calculate all possible moves to the end of the game).</p>
<p>The equilibrium RPS strategy is worked out below:</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Nash equilibrium strategy for RPS
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Player 1/2</th>
<th>Rock</th>
<th>Paper</th>
<th>Scissors</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Rock (<span class="math inline">r</span>)</strong></td>
<td>(0, 0)</td>
<td>(-1, 1)</td>
<td>(1, -1)</td>
</tr>
<tr class="even">
<td><strong>Paper (<span class="math inline">p</span>)</strong></td>
<td>(1, -1)</td>
<td>(0, 0)</td>
<td>(-1, 1)</td>
</tr>
<tr class="odd">
<td><strong>Scissors (<span class="math inline">s</span>)</strong></td>
<td>(-1, 1)</td>
<td>(1, -1)</td>
<td>(0, 0)</td>
</tr>
</tbody>
</table>
<p>If Player 1 plays Rock with probability <span class="math inline">r</span>, Paper with probability <span class="math inline">p</span>, and Scissors with probability <span class="math inline">s</span>, we have the following expected value equations for Player 2:</p>
<p><span class="math inline">\mathbb{E}[P_2(R)] = -1p + 1s</span></p>
<p><span class="math inline">\mathbb{E}[P_2(P)] = 1r - 1s</span></p>
<p><span class="math inline">\mathbb{E}[P_2(S)] = -1r + 1p</span></p>
<p>(To compute each of these, sum the payoffs for each column with P2 payoffs and P1 probabilities. P2 payoffs because these are the expected values for P2 and P1 probabiltiies because the payoffs depend on the strategy probabilties of P1 against each of P2’s actions.)</p>
<p>Since no action dominates, we know that the EV of every strategic action should be equal (since if a certain strategy was best, we’d want to always play that strategy).</p>
<p>To solve for <span class="math inline">r</span>, <span class="math inline">p</span>, and <span class="math inline">s</span>, we can start by setting these EVs equal:</p>
<p><span class="math inline">\mathbb{E}[P_2(R)] = \mathbb[P_2(P)]</span></p>
<p><span class="math inline">-1p + 1s = 1r - 1s</span></p>
<p><span class="math inline">2s = p + r</span></p>
<p>Then setting these equal:</p>
<p><span class="math inline">\mathbb{E}[P_2(R)] = \mathbb{E}[P_2(S)]</span></p>
<p><span class="math inline">-1p + 1s = -1r + 1p</span></p>
<p><span class="math inline">s + r = 2p</span></p>
<p>And finally setting these equal:</p>
<p><span class="math inline">\mathbb{E}[P_2(P)] = \mathbb{E}[P_2(S)]</span></p>
<p><span class="math inline">1r - 1s = -1r + 1p</span></p>
<p><span class="math inline">2r = s + p</span></p>
<p>Now we have these equations:</p>
<p><span class="math display">
\begin{cases}
2s = p + r \\
s + r = 2p \\
2r = s + p
\end{cases}
</span></p>
<p>We can rewrite the 1st:</p>
<p><span class="math inline">r = 2s - p</span></p>
<p>And combine with the 2nd:</p>
<p><span class="math inline">s + (2s - p) = 2p</span></p>
<p><span class="math inline">3s = 3p</span></p>
<p>Resulting in:</p>
<p><span class="math inline">s = p</span></p>
<p>Now we can go back to the 2nd equation:</p>
<p><span class="math inline">s + r = 2p</span></p>
<p>And insert <span class="math inline">s</span> = <span class="math inline">p</span>:</p>
<p><span class="math inline">s + r = 2s</span></p>
<p>And arrive at:</p>
<p><span class="math inline">r = s</span></p>
<p>We now see that all are equal:</p>
<p><span class="math inline">s = p = r</span></p>
<p>We also know that they must all sum to <span class="math inline">1</span>:</p>
<p><span class="math inline">r + p + s = 1</span></p>
<p>Since they’re all equal and sum to <span class="math inline">1</span>, we can substitute <span class="math inline">p</span> and <span class="math inline">s</span> with <span class="math inline">r</span>:</p>
<p><span class="math inline">3r = 1</span></p>
<p><span class="math inline">r = 1/3</span></p>
<p>So all actions are taken with probability <span class="math inline">1/3</span>:</p>
<p><span class="math inline">r = p = s = 1/3 \quad \blacksquare</span></p>
<p>By symmetry, the same equilibrium strategy is true for Player 2.</p>
</div>
</div>
</div>
<p>Playing this strategy means that whatever your opponent does, you will breakeven! For example, think about an opponent that always plays Rock.</p>
<p><span class="math display">
\begin{equation}
\begin{split}
\mathbb{E}(\text{Equilibrium vs. Rock}) &amp;= 0(r) + 1(p) + -1(s) \\
&amp;= 0(1/3) + 1(1/3) + -1(1/3) \\
&amp;= 0
\end{split}
\end{equation}
</span></p>
<p>How about the case of the opponent playing 60% Rock, 20% Paper, 20% Scissors?</p>
<p><span class="math display">
\begin{equation}
\begin{split}
\mathbb{E}(\text{Equilibrium vs. 622}) &amp;= 0.6(\text{Equilibrium vs. Rock}) \\
&amp;\quad{}+ 0.2(\text{Equilibrium vs. Paper}) \\  
&amp;\quad{}+ 0.2(\text{Equilibrium vs. Scissors}) \\
&amp;= 0.6(0) + 0.2(0) + 0.2(0) \\
&amp;= 0
\end{split}
\end{equation}
</span></p>
<p>The random equilibrium strategy will result in 0 against any pure strategy and any combination of strategies including <em>622</em> and the opponent playing the random strategy.</p>
</section>
<section id="exploiting-vs.-nash" class="level3">
<h3 class="anchored" data-anchor-id="exploiting-vs.-nash">Exploiting vs.&nbsp;Nash</h3>
<p>The equilibrium strategy vs.&nbsp;a pure Rock opponent is a useful illustration of the limitations of playing at equilibrium. The Rock opponent is playing the worst possible strategy, yet equilibrium is still breaking even!</p>
<p>What’s the best that we could do against Rock only? We could play <strong>purely paper</strong>.</p>
<p><span class="math display">
\begin{equation}
\begin{split}
\mathbb{E}(\text{Paper vs. Rock}) &amp;= 1(r) + 0(p) + -1(s) \\
&amp;= 1(1) + 0(0) + -1(0) \\
&amp;= 1
\end{split}
\end{equation}
</span></p>
<p>We’d win 1 each game playing Paper vs.&nbsp;Rock.</p>
<p>How about against the opponent playing 60% Rock, 20% Paper, 20% Scissors? Here we can see that because they are overplaying Rock, our best strategy is again to always play Paper.</p>
<p><span class="math display">
\begin{equation}
\begin{split}
\mathbb{E}(\text{Paper vs. 622}) &amp;= 1(r) + 0(p) + -1(s) \\
&amp;= 1(0.6) + 0(0.2) + -1(0.2) \\
&amp;= 0.6 + 0 - 0.2 \\
&amp;= 0.4
\end{split}
\end{equation}
</span></p>
<p>Playing Paper vs.&nbsp;622 results in an expected win of 0.4 per game.</p>
</section>
</section>
<section id="soccer-kicker-vs.-goalie" class="level2">
<h2 class="anchored" data-anchor-id="soccer-kicker-vs.-goalie">Soccer Kicker vs.&nbsp;Goalie</h2>
<p>Consider the <strong>Soccer Penalty Kick</strong> game where a Kicker is trying to score a goal and the Goalie is trying to block it.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kicker/Goalie</th>
<th>Lean Left</th>
<th>Lean Right</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Kick Left</strong></td>
<td>(0, 0)</td>
<td>(2, -2)</td>
</tr>
<tr class="even">
<td><strong>Kick Right</strong></td>
<td>(1, -1)</td>
<td>(0, 0)</td>
</tr>
</tbody>
</table>
<p>The game setup is zero-sum. If Kicker and Goalie both go in one direction, then it’s assumed that the goal will miss and both get 0 payoffs. If the Kicker plays Kick Right when the Goalie plays Lean Left, then the Kicker is favored and gets a payoff of +1. If the Kicker plays Kick Left when the Goalie plays Lean Right, then the kicker is even more favored, because it’s easier to kick left than right, and gets +2.</p>
<section id="nash-equilibrium-1" class="level3">
<h3 class="anchored" data-anchor-id="nash-equilibrium-1">Nash equilibrium?</h3>
<p>Which of these, if any, is a Nash equilibrium? You can check by seeing if either player would benefit by changing their action.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kicker</th>
<th>Goalie</th>
<th>Equilibrium or Change?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Left</td>
<td>Left</td>
<td></td>
</tr>
<tr class="even">
<td>Left</td>
<td>Right</td>
<td></td>
</tr>
<tr class="odd">
<td>Right</td>
<td>Left</td>
<td></td>
</tr>
<tr class="even">
<td>Right</td>
<td>Right</td>
<td></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-simple callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>There are no pure Nash equilibrium solutions because when the actions match, the Kicker will always want to change, and when they don’t match, the Goalie will always want to change.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kicker</th>
<th>Goalie</th>
<th>Equilibrium or Change?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Left</td>
<td>Left</td>
<td>Kicker changes to right</td>
</tr>
<tr class="even">
<td>Left</td>
<td>Right</td>
<td>Goalie changes to left</td>
</tr>
<tr class="odd">
<td>Right</td>
<td>Left</td>
<td>Goalie changes to right</td>
</tr>
<tr class="even">
<td>Right</td>
<td>Right</td>
<td>Kicker changes to left</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>Assume that they both play randomly – Left 50% and Right 50% – what is the expected value of the game?</p>
<div class="callout callout-style-simple callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kicker/Goalie</th>
<th>Lean Left (0.5)</th>
<th>Lean Right (0.5)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Kick Left (0.5)</strong></td>
<td>(0, 0)</td>
<td>(2, -2)</td>
</tr>
<tr class="even">
<td><strong>Kick Right (0.5)</strong></td>
<td>(1, -1)</td>
<td>(0, 0)</td>
</tr>
</tbody>
</table>
<p>We apply these probabilities to each of the 4 outcomes and write in terms of the Kicker payoffs:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kicker/Goalie</th>
<th>Lean Left (0.5)</th>
<th>Lean Right (0.5)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Kick Left (0.5)</strong></td>
<td>Val: 0 <br>Pr: 0.25</td>
<td>Val: 2 <br>Pr: 0.25</td>
</tr>
<tr class="even">
<td><strong>Kick Right (0.5)</strong></td>
<td>Val: 1 <br>Pr: 0.25</td>
<td>Val: 0 <br>Pr: 0.25</td>
</tr>
</tbody>
</table>
<p>Now for the Kicker, we have <span class="math inline">\mathbb{E}[K] = 0.25(0) + 0.25(2) + 0.25(1) + 0.25(0) = 0.75</span>.</p>
<p>Since it’s zero-sum, we have <span class="math inline">\mathbb{E}[G] = -0.75</span> for the Goalie.</p>
</div>
</div>
</div>
</section>
<section id="probabilistic-interpretations" class="level3">
<h3 class="anchored" data-anchor-id="probabilistic-interpretations">Probabilistic interpretations</h3>
<p>Note that, for example, the Kicker playing 50% Left and 50% Right could be interpreted as a single player having these probabilities or a field of players averaging to these probabilities. So out of 100 players, this could mean:</p>
<ul>
<li>100 players playing 50% Left and 50% Right</li>
<li>50 players playing 100% Left and 50 players playing 100% Right</li>
<li>50 players playing 75% Left/25% Right and 50 players playing 25% Left/75% right</li>
</ul>
</section>
<section id="finding-equilibrium" class="level3">
<h3 class="anchored" data-anchor-id="finding-equilibrium">Finding equilibrium</h3>
<p>When the Goalie plays left with probability <span class="math inline">p</span> and right with probability <span class="math inline">1-p</span>, we can find the expected value of the Kicker actions.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Kicker/Goalie</th>
<th>Lean Left (p)</th>
<th>Lean Right (1-p)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Kick Left</strong></td>
<td>(0, 0)</td>
<td>(2, -2)</td>
</tr>
<tr class="even">
<td><strong>Kick Right</strong></td>
<td>(1, -1)</td>
<td>(0, 0)</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\mathbb{E}[K(L)] = p(0) + (1-p)(2) = 2 - 2p</span></p>
<p><span class="math inline">\mathbb{E}[K(R)] = p(1) + (1-p)(0) = p</span></p>
<p>The Kicker is going to play the best response to the Goalie’s strategy. The Goalie wants to make the Kicker <strong>indifferent</strong> to Kick Left and Kick Right because if the Kicker was not going to be indifferent, then he would prefer one of the actions, meaning that action would be superior to the other. Therefore the Kicker will play a mixed strategy in response that will result in a Nash equilibrium where neither player benefits from unilaterally changing strategies. (Note that indifferent does not mean 50% each, but means the expected value is the same for each.)</p>
<p><img src="assets/kickergoalieplot.png" class="img-fluid"></p>
<p>By setting the values equal, we get <span class="math inline">2 - 2p = p \Rightarrow p = \frac{2}{3}</span> as shown in the plot.</p>
<p>This means that <span class="math inline">1-p = 1 - \frac{2}{3} = \frac{1}{3}</span>.</p>
<p>Therefore the Goalie should play Lean Left <span class="math inline">\frac{2}{3}</span> and Lean Right <span class="math inline">\frac{1}{3}</span>.</p>
<p>The value for the Kicker is <span class="math inline">\frac{2}{3}</span>, or <span class="math inline">(0.67)</span>, for both actions, regardless of the Kicker’s mixing strategy.</p>
<p>Note that the Kicker is worse off now (<span class="math inline">0.67</span> now compared to <span class="math inline">0.75</span>) than when both players played 50% each action. Why?</p>
<p>If the Kicker plays Left with probability <span class="math inline">q</span> and Right with probability <span class="math inline">1-q</span>, then the Goalie’s values are:</p>
<p><span class="math inline">\mathbb{E}(\text{Lean Left}) = 0q - 1(1-q) = -1 + q</span></p>
<p><span class="math inline">\mathbb{E}(\text{Lean Right}) = -2q + 0 = -2q</span></p>
<p>Setting equal,</p>
<p><span class="math display">
\begin{equation}
\begin{split}
-1 + q &amp;= -2q \\
-1 &amp;= -3q  \\
\frac{1}{3} &amp;= q
\end{split}
\end{equation}
</span></p>
<p>Therefore the Kicker should play Left <span class="math inline">\frac{1}{3}</span> and Right <span class="math inline">\frac{2}{3}</span>, giving a value of <span class="math inline">-\frac{2}{3}</span> to the Goalie.</p>
<p>We can see this from the game table:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 35%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Kicker/Goalie</th>
<th>Lean Left (<span class="math inline">\frac{2}{3}</span>)</th>
<th>Lean Right (<span class="math inline">\frac{1}{3}</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Kick Left (<span class="math inline">\frac{1}{3}</span>)</strong></td>
<td>Val: (0, 0) <br>Pr: (<span class="math inline">\frac{2}{9}</span>)</td>
<td>Val: (2, -2) <br>Pr: (<span class="math inline">\frac{1}{9}</span>)</td>
</tr>
<tr class="even">
<td><strong>Kick Right (<span class="math inline">\frac{2}{3}</span>)</strong></td>
<td>Val: (1, -1) <br>Pr: (<span class="math inline">\frac{4}{9}</span>)</td>
<td>Val: (0, 0) <br>Pr: (<span class="math inline">\frac{2}{9}</span>)</td>
</tr>
</tbody>
</table>
<p>Therefore the expected payoffs in this game are:</p>
<p><span class="math inline">\mathbb{E}[K] = \frac{2}{9}(0) + \frac{1}{9}(2) + \frac{4}{9}(1) + \frac{2}{9}(0) = \frac{6}{9} = 0.67</span> for the Kicker and <span class="math inline">-0.67</span> for the Goalie.</p>
</section>
<section id="switching-out-of-equilibrium" class="level3">
<h3 class="anchored" data-anchor-id="switching-out-of-equilibrium">Switching out of equilibrium</h3>
<p>In an equilibrium, no player should be able to unilaterally improve by changing their strategy. What if the Kicker switches to always Kick Left?</p>
<table class="caption-top table">
<colgroup>
<col style="width: 38%">
<col style="width: 35%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>Kicker/Goalie</th>
<th>Lean Left (<span class="math inline">\frac{2}{3}</span>)</th>
<th>Lean Right (<span class="math inline">\frac{1}{3}</span>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Kick Left (<span class="math inline">1</span>)</strong></td>
<td>Val: (0, 0) <br>Pr: (<span class="math inline">\frac{2}{3}</span>)</td>
<td>Val: (2, -2) <br>Pr: (<span class="math inline">\frac{1}{3}</span>)</td>
</tr>
<tr class="even">
<td><strong>Kick Right (<span class="math inline">0</span>)</strong></td>
<td>Val: (1, -1) <br>Pr: (<span class="math inline">0</span>)</td>
<td>Val: (0, 0) <br>Pr: (<span class="math inline">0</span>)</td>
</tr>
</tbody>
</table>
<p>Now the Kicker’s payoff is still <span class="math inline">\frac{1}{3}(2) = 0.67</span>.</p>
<p>When a player makes their opponent indifferent, this means that any action the opponent takes (within the set of equilibrium actions) will result in the same payoff!</p>
<p>So if you know your opponent is playing the equilibrium strategy, then you can actually do whatever you want with no penalty with the mixing actions. Sort of.</p>
<p>The risk is that the opponent can now deviate from equilibrium and take advantage of your new strategy. For example, if the Goalie caught on and moved to always Lean Left, then the value is reduced to <span class="math inline">0</span> for both players. Though if the Kicker then caught on and moved to always Kick Right, then the value goes up to <span class="math inline">1</span> for the Kicker and <span class="math inline">-1</span> for the Goalie. Perhaps after a few cycles like this, the players would go back to equilibrium.</p>
<p>To summarize, you can only be penalized for not playing the equilibrium mixing strategy if your opponent plays a non-equilibrium strategy that exploits your strategy. You can only profit more than the equilibrium strategy if your opponent either plays off equilibrium and you do as well or if you play equilibrium and they play some action that is not part of the equilibrium strategy (also known as the support, or the set of pure strategies that are played with non-zero probability under the mixed strategy, which is not possible in this game since both possible actions are played at equilibrium).</p>
</section>
<section id="whats-up-with-indifference" class="level3">
<h3 class="anchored" data-anchor-id="whats-up-with-indifference">What’s up with indifference?</h3>
<p>Why do players make their opponent indifferent? When you make your opponent indifferent, then you don’t give them any best play.</p>
</section>
<section id="deviating-from-nash" class="level3">
<h3 class="anchored" data-anchor-id="deviating-from-nash">Deviating from Nash</h3>
<p>Best response to each other in equilibrium, no incentive to deviate. Deviate means no longer in equilibrium, though EV is same. only guarantee worst-case payoff of 0 if you randomize</p>
</section>
<section id="indifference" class="level3">
<h3 class="anchored" data-anchor-id="indifference">Indifference</h3>
<p>why is fundamental goal to make other player indifferent? if deviate, indifference guarantees can’t improve by changing unliterally</p>
</section>
</section>
<section id="clairvoyance-poker" class="level2">
<h2 class="anchored" data-anchor-id="clairvoyance-poker">Clairvoyance Poker</h2>
<p>Back to poker. We previously built <strong>Face-up 3-card Poker</strong> where each player was dealt a card from the deck of {0, 1, 2} and the high card won.</p>
<p>Now we’re going to make the game more interesting with the same deck. This game was first shown in The Mathematics of Poker (Bill Chen, Jared Ankenman) and then also in the excellent Play Optimal Poker 1 (Andrew Brokos).</p>
<ul>
<li><p>Player 1 will <em>always</em> be dealt card 1.</p></li>
<li><p>Player 2 will be dealt randomly from {0, 2}.</p></li>
<li><p>P1 knows P2 has either card 0 or 2, but not which. P2 knows that P1 has card 1.</p></li>
<li><p>This is representative of a real poker scenario where P1 has a mid-strength hand that can beat bluffs, but loses to value bets by strong hands. P2 has either a bluff (weak hand) or a strong hand.</p></li>
</ul>
<p>Let’s modify the code to update the deal:</p>
<div class="callout callout-style-simple callout-tip no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Update <code>deal_cards</code> function
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> deal_cards(<span class="va">self</span>):</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cards[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>        remaining_cards <span class="op">=</span> [card <span class="cf">for</span> card <span class="kw">in</span> <span class="va">self</span>.deck <span class="cf">if</span> card <span class="op">!=</span> <span class="va">self</span>.cards[<span class="dv">0</span>]]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cards[<span class="dv">1</span>] <span class="op">=</span> random.choice(remaining_cards)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<section id="equity-and-variance" class="level3">
<h3 class="anchored" data-anchor-id="equity-and-variance">Equity and Variance</h3>
<p><strong>Equity</strong> is defined as the percentage of the pot expected to win given the cards, assuming no additional betting. We see that in the original case where players were randomly dealt cards <em>and</em> in this case, both players have 50% equity before the cards are dealt. After the cards are dealt, the higher card has 100% equity.</p>
<p>In real poker games like Texas Hold’em, equity is more interesting because there are additional community cards that mean that even if one hand starts off as stronger, it won’t necessarily win. Below we have a special poker hand where the equities are shown as 53% and 47% and the hand currently losing actually has higher equity!</p>
<p><img src="assets/equity.png" class="img-fluid"></p>
<p><strong>Variance</strong> measures the spread of the score differences. Higher variance means more volatility in the outcomes.</p>
<p>We can run a sample of games and get an empirical sample for:</p>
<ul>
<li>Equity:</li>
<li>Variance</li>
<li>Winrate:</li>
</ul>
<p>Standard Error: This measures the precision of our sample mean as an estimate of the population mean. Confidence Interval: This gives us a range where we expect the true population mean to lie with 95% confidence.</p>
</section>
<section id="betting-rules-and-sequences" class="level3">
<h3 class="anchored" data-anchor-id="betting-rules-and-sequences">Betting Rules and Sequences</h3>
<ul>
<li><p>Both players ante 1 chip, so the starting pot is 2</p></li>
<li><p>Each player has 1 remaining chip to use for betting</p></li>
<li><p>Player 1 acts first and can either Bet 1 or Check (Pass)</p></li>
</ul>
<p>Play continues until one of these betting sequences happens, which ends the hand:</p>
<ul>
<li><p><strong>Check Check:</strong> Hands go to <em>showdown</em> and player with highest card wins 1 (the ante)</p></li>
<li><p><strong>Bet Call:</strong> Hands go to <em>showdown</em> and player with highest card wins 2 (the ante + bet)</p></li>
<li><p><strong>Bet Fold:</strong> Player who bets wins 1 (the ante)</p></li>
</ul>
<p>Here is a list of all possible betting sequences:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>P1</th>
<th>P2</th>
<th>P1</th>
<th>Winner</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Bet</td>
<td>Fold</td>
<td></td>
<td>P1 (+1)</td>
</tr>
<tr class="even">
<td>Bet</td>
<td>Call</td>
<td></td>
<td>Higher Card (+2)</td>
</tr>
<tr class="odd">
<td>Check</td>
<td>Check</td>
<td></td>
<td>Higher Card (+1)</td>
</tr>
<tr class="even">
<td>Check</td>
<td>Bet</td>
<td>Fold</td>
<td>P2 (+1)</td>
</tr>
<tr class="odd">
<td>Check</td>
<td>Bet</td>
<td>Call</td>
<td>Higher Card (+2)</td>
</tr>
</tbody>
</table>
</section>
<section id="starting-strategies" class="level3">
<h3 class="anchored" data-anchor-id="starting-strategies">Starting Strategies</h3>
<p>There are six possible states of the game, two for P1 and four for P2. Let’s hard-code some initial strategies for both players:</p>
<ul>
<li>P1[1, Starting]: Randomly Bet/Check</li>
<li>P2[0, After Bet]: Fold</li>
<li>P2[2, After Bet]: Call</li>
<li>P2[0, After Check]: Randomly Bet/Check</li>
<li>P2[2, After Check]: Bet</li>
<li>P1[1, After Check and Bet]: Randomly Bet/Check</li>
</ul>
<p>This strategy randomizes uncertain decisions and takes clearly smart decisions when possible. What does that mean?</p>
<ul>
<li>P2[0, After Bet]: Fold
<ul>
<li>This is the worst card and can’t win</li>
</ul></li>
<li>P2[2, After Bet]: Call
<ul>
<li>This is the best hand and guarantees a win</li>
</ul></li>
<li>P2[2, After Check]: Bet
<ul>
<li>This is the best card and betting can only possibly win additional chips</li>
</ul></li>
</ul>
<p>Let’s put the strategies into our code and see how each strategy is doing. There are 9 total state-action pairs bolded below:</p>
<ul>
<li>P1[1, Starting]: Randomly Bet/Check
<ul>
<li><strong>P2[0, Starting]: Bet</strong></li>
<li><strong>P2[0, Starting]: Check</strong></li>
</ul></li>
<li><strong>P2[0, After Bet]: Fold</strong></li>
<li><strong>P2[2, After Bet]: Call</strong></li>
<li>P2[0, After Check]: Randomly Bet/Check
<ul>
<li><strong>P2[0, After Check]: Bet</strong></li>
<li><strong>P2[0, After Check]: Check</strong></li>
</ul></li>
<li><strong>P2[2, After Check]: Bet</strong></li>
<li>P1[1, After Check and Bet]: Randomly Bet/Check
<ul>
<li><strong>P2[0, After Check and Bet]: Bet</strong></li>
<li><strong>P2[0, After Check and Bet]: Check</strong></li>
</ul></li>
</ul>
<p>—&gt; show wins/losses, frequency, total for each strategic decision P1 bet, P1 check/call, P1 check/fold P2 0 after bet call, P2 0 after bet fold, P2 0 after check bet, P2 0 after check check P2 2 after bet call, P2 2 after bet fold, P2 2 after check bet, P2 2 after check check</p>
</section>
<section id="dominated-strategy" class="level3">
<h3 class="anchored" data-anchor-id="dominated-strategy">Dominated Strategy</h3>
<p>Note that P1 betting is strictly worse and why</p>
</section>
<section id="your-strategies" class="level3">
<h3 class="anchored" data-anchor-id="your-strategies">Your Strategies</h3>
<p>—&gt; Try strat for P1 then for P2 See results</p>
</section>
<section id="indifference-in-poker" class="level3">
<h3 class="anchored" data-anchor-id="indifference-in-poker">Indifference in Poker</h3>
<p>Figuring out strategy for 0 facing check, actually thinking about strategy for 0 and 2. goal indifference</p>
<p>EV folding 0, EV calling should also be 0</p>
<p>shows EV = bluff<em>3 - value</em>1 (but this is for overall range 1/4 bluffs)</p>
<p>bluff to value ratio bet/(bet+pot)</p>
<p>Figuring out strategy for 1 after check/bet</p>
<p>bluffing frequency goes up as bet size gets larger relative to pot</p>
<p>Only mix when both same EV</p>
<p>Making P1 indifferent between calling and folding with a K</p>
<p>We can work out Player 2’s betting strategy by calculating the indifference. Let <span class="math inline">b</span> be the probability that P2 bets with a Q after P1 checks.</p>
<p><span class="math display">\begin{equation}
\begin{split}
\mathbb{E}(\text{P1 Check K then Fold to Bet}) &amp;= 0 \\
\\

\mathbb{E}(\text{P1 Check K then Call Bet}) &amp;= -1*\Pr(\text{P2 has A and Bets}) + 3*\Pr(\text{P2 has Q and Bets}) \\
  &amp;= -1*\frac{1}{2} + 3*\frac{1}{2}*b \\
  &amp;= -0.5 + 1.5*b
\end{split}
\end{equation}</span></p>
<p>Setting these equal:</p>
<p><span class="math inline">0 = -0.5 + 1.5*b</span></p>
<p><span class="math inline">b = \frac{1}{3}</span></p>
<p>Therefore in equilibrium, P2 should bet <span class="math inline">\frac{1}{3}</span> with Q after P1 checks.<br>
:::</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Equilibrium Mixed Strategy Change Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>If P2 bet <span class="math inline">\frac{2}{3}</span> instead of <span class="math inline">\frac{1}{3}</span> with Q after P1 checks and P1 is playing an equilibrium strategy, how would P2’s expected value change?</p>
</div>
</div>
<div class="callout callout-style-simple callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>It wouldn’t! As long as P1 doesn’t modify their equilibrium strategy, then P2 can mix his strategy (at mixing infosets) however he wants and have the same EV.</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Bluff:Value Ratio Exercise
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given that P2 has bet after P1 checks and is playing the equilibrium strategy, what is the probability that they are bluffing?</p>
<p>(Note: Including cases where you have an A, so Q bets are bluffs and A bets are value bets.)</p>
</div>
</div>
<div class="callout callout-style-simple callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>P2 has Q and A each <span class="math inline">\frac{1}{2}</span> of the time.</p>
<p>P2 is betting Q <span class="math inline">\frac{1}{3}</span> of the time (bluffing).</p>
<p>P2 is betting A always (value betting).</p>
<p>Therefore for every 3 times you have Q you will bet once and for every 3 times you have A you will bet 3 times. Out of the 4 bets, 1 of them is a bluff.</p>
<p><span class="math inline">\Pr(\text{P2 Bluff after P1 Check}) = \frac{1}{4}</span></p>
</div>
</div>
</div>
<p>call strategy wants indifferent between betting and checking card 0 checking 0 has EV 0 betting 0 also needs to have EV 0</p>
<p>EV = fold<em>2 - call</em>1 get call = 2/3 1 - bet/(bet+pot) larger bet means call less, let them get away with bluffs the bigger they bet</p>
</section>
<section id="equity-vs.-expected-value" class="level3">
<h3 class="anchored" data-anchor-id="equity-vs.-expected-value">Equity vs.&nbsp;Expected Value</h3>
<p>can tell opponent strategy to bet 1/3 0s but can’t stop call more catches more bluffs, but pays off more value bets</p>
<p>Sometimes have to bluff with bad cards because EV higher than if you always folded with bad cards.</p>
<p>Add uncertainty the opponent has to think about in counter-strategy If always folded bad cards, opponent knows you keep playing with good #</p>
</section>
<section id="exploits" class="level3">
<h3 class="anchored" data-anchor-id="exploits">exploits</h3>
<p>bet all good, check all bad opponent can always fold Then switch to always betting Then switch to awlasy calling Then move to betting strong, checking weak</p>
<p>bluffing combined with value betting is the profitable thing. players who fold too often lose to bluffs, call too often lose value to value bets. betting to bluff and call ratios adepend on pot size</p>
</section>
<section id="bonus-bet-sizing" class="level3">
<h3 class="anchored" data-anchor-id="bonus-bet-sizing">Bonus: Bet Sizing</h3>
<p>pot sizing affects strategy pot large etc. –&gt; Add pot size stuff</p>



</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© 2024 Overbet.ai. All rights reserved.</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>